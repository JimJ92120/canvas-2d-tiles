(()=>{"use strict";var t={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},s=[],a=0;a<t.length;a++){var c=t[a],h=i.base?c[0]+i.base:c[0],d=o[h]||0,u="".concat(h," ").concat(d);o[h]=d+1;var l=n(u),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==l)e[l].references++,e[l].updater(m);else{var p=r(m,i);i.byIndex=a,e.splice(a,0,{identifier:u,updater:p,references:1})}s.push(u)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var c=i(t,r),h=0;h<o.length;h++){var d=n(o[h]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}o=c}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},208:(t,e,n)=>{n.d(e,{A:()=>a});var i=n(601),r=n.n(i),o=n(314),s=n.n(o)()(r());s.push([t.id,"body {\n  margin: 0;\n\n  min-height: 100vh;\n  background-color: black;\n  color: white;\n}\n\nbody > * {\n  box-sizing: border-box;\n}\n\n#app {\n  display: flex;\n  flex-flow: column;\n  margin-left: auto;\n  margin-right: auto;\n\n  position: relative;\n  max-width: 500px;\n}\n\n.scene {\n  background-color: lightblue;\n}\n.debug-scene {\n  display: none;\n  background-color: lightgrey;\n  border: 1px solid red;\n}\n\n.prompt {\n  background-color: white;\n  color: black;\n\n  display: none;\n  position: absolute;\n  bottom: 0;\n  padding: 1rem;\n  width: calc(100% - 2rem);\n  white-space: pre-wrap;\n}\n\n.prompt--active,\n.prompt--active-debug {\n  display: block;\n}\n.prompt * {\n  font-size: 1rem;\n  margin: 0;\n  padding: 0;\n}\n\n/* debug */\n.app--debug {\n  .debug-scene {\n    display: block;\n  }\n\n  .prompt--active {\n    bottom: 50%;\n  }\n}\n",""]);const a=s},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var h=0;h<t.length;h++){var d=[].concat(t[h]);i&&s[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),e.push(d))}},e}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=i[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.nc=void 0;var i=n(72),r=n.n(i),o=n(825),s=n.n(o),a=n(659),c=n.n(a),h=n(56),d=n.n(h),u=n(540),l=n.n(u),m=n(113),p=n.n(m),f=n(208),v={};v.styleTagTransform=p(),v.setAttributes=d(),v.insert=c().bind(null,"head"),v.domAPI=s(),v.insertStyleElement=l(),r()(f.A,v),f.A&&f.A.locals&&f.A.locals;class y{constructor(t){this.$container=t}render(){this.$container.innerHTML='\n      <canvas class="scene"></canvas>\n      <div class="prompt">Hello world</div>\n\n      <canvas class="debug-scene"></canvas>\n  '}}var g=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};class w{constructor(t,e,n={}){this.currentContent=[],this.currentContentIndex=0,this.$container=t,this.activeClassName=e,this.animationRecord=n}get isShown(){return this.$container.classList.contains(this.activeClassName)}show(t){return g(this,void 0,void 0,(function*(){t instanceof Array?this.isShown?console.error("prompt is already shown"):(this.currentContent=t,yield this.showCurrentContent(),this.$container.classList.add(this.activeClassName)):console.error("content is not an array:",t)}))}hide(){return g(this,void 0,void 0,(function*(){this.animationRecord.onHide&&(yield this.animationRecord.onHide(this.$container,this.currentContent[this.currentContentIndex])),this.currentContentIndex=0,this.currentContent=[],this.$container.innerHTML="",this.$container.classList.remove(this.activeClassName)}))}next(){return g(this,void 0,void 0,(function*(){return this.isShown?(++this.currentContentIndex,!(this.currentContent.length<=this.currentContentIndex)&&this.showCurrentContent()):(console.error("prompt not shown"),!1)}))}showCurrentContent(){return g(this,void 0,void 0,(function*(){return this.currentContent[this.currentContentIndex]?(this.$container.innerHTML="",this.animationRecord.onShow?yield this.animationRecord.onShow(this.$container,this.currentContent[this.currentContentIndex]):this.$container.textContent=this.currentContent[this.currentContentIndex],!0):(console.error(`current content index ${this.currentContentIndex} not found`),!1)}))}}var b,x,F,R,S=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};!function(t){t[t.Default=0]="Default",t[t.Raw=1]="Raw",t[t.All=2]="All"}(b||(b={}));class P{constructor(t,e,n){this.assetRecord={},this.$scene=t,this.context=this.$scene.getContext("2d"),this.viewOffset=e,this.options=n}get width(){return this.$scene.width}get height(){return this.$scene.height}getTileSize(t){const{scene:e}=this.options;return e.minimumFrameSize?[e.size[0]/e.minimumFrameSize[0],e.size[1]/e.minimumFrameSize[1]]:[e.size[0]/t[0],e.size[1]/t[1]]}resize(t,e){this.options.scene.minimumFrameSize=[t,e];const n=this.getTileSize([t,e]);this.$scene.width=t*n[0],this.$scene.height=e*n[1]}init(){const{minimumFrameSize:t}=this.options.scene;this.resize(t[0],t[1])}loadAssets(t,e){return S(this,void 0,void 0,(function*(){return yield Promise.all(Object.keys(e).map((n=>this.loadImage(`${t}-${n}`,e[n]))))}))}render(t,e,n,i,r){const{scene:o,mode:s}=this.options;this.context.clearRect(0,0,this.width,this.height);const a=[r[0].length,r.length],c=this.getTileSize(a);o.minimumFrameSize&&(o.minimumFrameSize[0]<a[0]||o.minimumFrameSize[1]<a[1])?this.focus(n,a):0===this.viewOffset[0]&&0===this.viewOffset[1]||(this.viewOffset=[0,0]);const h=[(n[0]-this.viewOffset[0])*c[0],(n[1]-this.viewOffset[1])*c[1]];switch(s){case b.All:this.renderRawData(r,c),this.renderDataWithAssets(t,r,c),this.renderRawCharacter(e,h,i,c),this.renderCharacterWithAssets(e,h,i,c);break;case b.Default:this.renderDataWithAssets(t,r,c),this.renderCharacterWithAssets(e,h,i,c);break;case b.Raw:this.renderRawData(r,c),this.renderRawCharacter(e,h,i,c)}}focus(t,e){const{scene:n}=this.options;if(!n.minimumFrameSize)return;const i=[0==n.minimumFrameSize[0]%2?Math.floor(n.minimumFrameSize[0]/2)-1:Math.floor(n.minimumFrameSize[0]/2),0==n.minimumFrameSize[1]%2?Math.floor(n.minimumFrameSize[1]/2)-1:Math.floor(n.minimumFrameSize[1]/2)];let r=[i[0]>=t[0]?0:t[0]-i[0],i[1]>=t[1]?0:t[1]-i[1]];e[0]<r[0]+n.minimumFrameSize[0]&&(r[0]=e[0]-n.minimumFrameSize[0]),e[1]<r[1]+n.minimumFrameSize[1]&&(r[1]=e[1]-n.minimumFrameSize[1]),this.viewOffset=r}loadImage(t,e){return S(this,void 0,void 0,(function*(){return new Promise((n=>{this.assetRecord[t]=new Image,this.assetRecord[t].src=e,this.assetRecord[t].addEventListener("load",(()=>(console.log(`${t} image loaded`),n(this.assetRecord[t]))))}))}))}renderRawCharacter(t,e,n,i){const{characters:r}=this.options;this.context.fillStyle=r[t].color,this.context.fillRect(e[0],e[1],i[0],i[1]);let o=[e[0],e[1]];switch(n){case"up":o[0]+=i[0]/2;break;case"down":o[0]+=i[0]/2,o[1]+=i[1];break;case"left":o[1]+=i[1]/2;break;case"right":o[0]+=i[0],o[1]+=i[1]/2;break;default:return}this.context.strokeStyle="black",this.context.lineWidth=5,this.context.beginPath(),this.context.moveTo(e[0]+i[0]/2,e[1]+i[1]/2),this.context.lineTo(o[0],o[1]),this.context.stroke()}renderCharacterWithAssets(t,e,n,i){const r=this.assetRecord[`${t}-${n}`];r?this.context.drawImage(r,e[0],e[1],i[0],i[1]):b.Default===this.options.mode&&this.renderRawCharacter(t,e,n,i)}renderRawData(t,e){const{tile:n,scene:i}=this.options;let r=[...t];i.minimumFrameSize&&(r=t.slice(this.viewOffset[1],this.viewOffset[1]+i.minimumFrameSize[1]).map((t=>t.slice(this.viewOffset[0],this.viewOffset[0]+i.minimumFrameSize[0])))),r.map(((t,i)=>{t.map(((t,r)=>{t&&n.colors[t]&&(this.context.fillStyle=n.colors[t],this.context.fillRect(r*e[0],i*e[1],e[0],e[1]))}))}))}renderDataWithAssets(t,e,n){this.assetRecord[`frame-${t}-background`]?this.context.drawImage(this.assetRecord[`frame-${t}-background`],-this.viewOffset[0]*n[0],-this.viewOffset[1]*n[1],e[0].length*n[0],e.length*n[1]):b.Default===this.options.mode&&this.renderRawData(e,n)}}!function(t){t[t.Empty=0]="Empty",t[t.Block=1]="Block",t[t.Building=2]="Building",t[t.Action=3]="Action"}(x||(x={})),function(t){t.Prompt="prompt",t.Load="load"}(F||(F={}));class C{constructor(t,e,n,i){this.data=t,this.actionRecord=e,this.initialPlayerPosition=n,this.assetRecord=i}get width(){return this.data[0].length}get height(){return this.data.length}runAction(t,e){const n=this.getAction(t);n?e(n):console.error(`no action found at [${t}]`)}getAction(t){return this.actionRecord[t.join(":")]||null}}!function(t){t.Up="up",t.Down="down",t.Left="left",t.Right="right"}(R||(R={}));var $=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};class A{constructor(t,e,n,i){this.frameRecord={},this.currentFrameKey="main",this.mapRenderer=null,this.mainFrameLastPosition=[0,0],this.player=t,this.frameRecord=e,this.renderer=new P(n.$scene,n.viewOffset,n.options),n.mapScene&&(this.mapRenderer=new P(n.mapScene.$scene,[0,0],Object.assign(Object.assign({},n.options),{mode:n.mapScene.mode,scene:{size:[...n.options.scene.size],minimumFrameSize:[0,0]}}))),this.prompt=new w(i.$prompt,i.activeClassName,i.animationRecord)}get isPromptShown(){return this.prompt.isShown}get currentFrame(){return this.frameRecord[this.currentFrameKey]}init(){return $(this,void 0,void 0,(function*(){this.loadFrame("main"),this.renderer.init(),yield this.loadAssets(this.renderer),this.mapRenderer&&(this.mapRenderer.init(),[b.Default,b.All].includes(this.mapRenderer.options.mode)&&(yield this.loadAssets(this.mapRenderer))),this.render()}))}render(){this.renderer.render(this.currentFrameKey,"player",this.player.position,this.player.direction,this.currentFrame.data),this.mapRenderer&&this.mapRenderer.render(this.currentFrameKey,"player",this.player.position,this.player.direction,this.currentFrame.data)}nextOrHidePrompt(){return $(this,void 0,void 0,(function*(){return!!(yield this.prompt.next())||(this.prompt.hide(),!1)}))}movePlayer(t){return $(this,void 0,void 0,(function*(){yield this.prompt.hide();const e=this.getDirectionFromKey(t);if(!e)return!1;const n=this.getPlayerPositionFromDirection(e);if(!this.isPositionValid(n))return!1;const i=this.currentFrame.data[n[1]][n[0]];switch(this.player.direction=e,i){case x.Empty:return this.player.position=n,!0;case x.Block:case x.Building:return!1;case x.Action:return this.runFrameAction(n),!0;default:return!1}}))}loadAssets(t){return $(this,void 0,void 0,(function*(){yield t.loadAssets("player",this.player.assetRecord),yield Promise.all(Object.keys(this.frameRecord).map((e=>t.loadAssets(`frame-${e}`,this.frameRecord[e].assetRecord))))}))}loadFrame(t){if(!this.frameRecord[t])return;const e=this.currentFrameKey;this.currentFrameKey=t,"main"!==this.currentFrameKey||"main"===this.currentFrameKey&&this.currentFrameKey===e?(this.mainFrameLastPosition=this.player.position,this.player.position=this.currentFrame.initialPlayerPosition):this.player.position=this.mainFrameLastPosition,this.mapRenderer&&this.mapRenderer.resize(this.currentFrame.width,this.currentFrame.height)}isPositionValid(t){return 0>t[0]||0>t[1]||this.currentFrame.width<=t[0]||this.currentFrame.height<=t[1]?(console.error(`nextPosition [${t}] is out of bound`),!1):this.currentFrame.data[t[1]]&&!isNaN(Number(this.currentFrame.data[t[1]][t[0]]))}getDirectionFromKey(t){let e=null;switch(t){case"up":e=R.Up;break;case"down":e=R.Down;break;case"left":e=R.Left;break;case"right":e=R.Right}return e}getPlayerPositionFromDirection(t){let e=[...this.player.position];switch(t){case R.Up:--e[1];break;case R.Down:++e[1];break;case R.Left:--e[0];break;case R.Right:++e[0]}return e}runFrameAction(t){return $(this,void 0,void 0,(function*(){yield this.currentFrame.runAction(t,(t=>$(this,void 0,void 0,(function*(){switch(t.type){case F.Prompt:yield this.prompt.show(t.data);break;case F.Load:this.loadFrame(t.data)}}))))}))}}const k=n.p+"assets/map.png",z=new C([[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,2,2,2,1,2,2,2,2,2,2,1,1,1,1,2,2,2,1,1],[1,2,3,2,1,2,2,3,3,2,2,1,1,1,1,2,3,2,1,1],[1,1,0,1,1,1,0,0,0,0,1,1,1,1,0,0,0,1,1,1],[1,1,0,1,1,1,0,0,0,0,0,0,0,1,1,1,0,1,1,1],[1,1,0,1,1,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1],[1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,0,0,0,0,0,1,0,0,0,0,0,2,2,2,2,2,2,1],[1,1,1,1,1,1,1,1,0,0,0,0,0,2,3,2,2,3,2,1],[1,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,1],[1,2,2,3,3,2,2,2,3,2,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,1],[1,1,1,1,0,0,0,0,0,0,0,0,0,2,2,3,3,2,2,1],[1,1,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,2,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],{"2:2":{type:F.Prompt,data:["a small building"]},"7:2":{type:F.Prompt,data:["a large building"]},"8:2":{type:F.Prompt,data:["a large building"]},"16:2":{type:F.Prompt,data:["a small building"]},"14:10":{type:F.Prompt,data:["a small building"]},"17:10":{type:F.Prompt,data:["a small building"]},"3:12":{type:F.Prompt,data:["a large building","closed"]},"4:12":{type:F.Prompt,data:["a large building","closed"]},"8:12":{type:F.Prompt,data:["a small building\nclosed"]},"15:14":{type:F.Prompt,data:["a large building"]},"16:14":{type:F.Prompt,data:["a large building"]},"3:16":{type:F.Load,data:"home"}},[3,17],{background:k}),I=new C([[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,3,1,3,1,1,1],[1,1,2,0,0,0,0,1,1,1],[1,1,3,0,0,0,0,1,1,1],[1,1,2,0,0,0,0,3,1,1],[1,1,1,0,0,0,0,3,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,3,3,1,1,1,1],[1,1,1,1,1,1,1,1,1,1]],{"2:4":{type:F.Prompt,data:["desk"]},"4:2":{type:F.Prompt,data:["guitar"]},"6:2":{type:F.Prompt,data:["tinkering"]},"7:5":{type:F.Prompt,data:["shelf"]},"7:6":{type:F.Prompt,data:["moto"]},"4:8":{type:F.Load,data:"main"},"5:8":{type:F.Load,data:"main"}},[4,7],{}),L=n.p+"assets/player-up.png",O=n.p+"assets/player-down.png",T=n.p+"assets/player-left.png",D=n.p+"assets/player-right.png",M=new class{constructor(t,e,n){this.position=t,this.direction=e,this.assetRecord=n}}([0,0],R.Up,{up:L,down:O,left:T,right:D});var E=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};class N{constructor(t){this.typingInterval=0,this.$container=t}get isTyping(){return Boolean(this.typingInterval)}clear(){this.clearInterval()}type(t,e){return E(this,void 0,void 0,(function*(){return new Promise((n=>E(this,void 0,void 0,(function*(){this.isTyping&&console.error("prompt is already typing"),this.$container.innerHTML="",t instanceof HTMLElement||(yield this.typeString(t,e)),n()}))))}))}typeString(t,e){return E(this,void 0,void 0,(function*(){const n=t.split("\n");this.clearInterval();let i=0,r=0;return new Promise((t=>{this.typingInterval=setInterval((()=>{try{0===r&&0!==i&&(this.$container.textContent+="\n"),this.$container.textContent+=n[i][r],n[i].length<=r+1?(++i,r=0):++r}catch(t){this.clearInterval()}}),e),t()}))}))}clearInterval(){clearInterval(this.typingInterval),this.typingInterval=0}}var H=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))};const j=[10,10];document.addEventListener("DOMContentLoaded",(()=>H(void 0,void 0,void 0,(function*(){const t=function(){const{width:t,height:e}=window.screen;let n=e<=t?e:t;return 500<n&&(n=500),n}(),e=new y(document.querySelector("#app"));e.render(),e.$container.style.maxWidth=`${t}px`,e.$container.classList.add("app--debug");let n={$scene:e.$container.querySelector(".scene"),viewOffset:[0,0],mapScene:{$scene:e.$container.querySelector(".debug-scene"),mode:b.Raw},options:{mode:b.Default,scene:{size:[t,t],minimumFrameSize:j},tile:{colors:{1:"grey",2:"blue",3:"green"}},characters:{player:{color:"red"}}}};const i={$prompt:e.$container.querySelector(".prompt"),activeClassName:"prompt--active",animationRecord:{}},r={main:z,home:I},o=new N(i.$prompt);i.animationRecord={onShow:(t,e)=>new Promise((t=>H(void 0,void 0,void 0,(function*(){yield o.type(e,50),t()})))),onHide:()=>new Promise((t=>{o.clear(),t()}))};const s=new A(M,r,n,i);yield s.init(),function(t){document.addEventListener("keyup",(e=>{return n=this,i=void 0,o=function*(){switch(e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":yield t.movePlayer(e.key.replace("Arrow","").toLowerCase()),t.render();break;case"Escape":case" ":yield t.nextOrHidePrompt()}},new((r=void 0)||(r=Promise))((function(t,e){function s(t){try{c(o.next(t))}catch(t){e(t)}}function a(t){try{c(o.throw(t))}catch(t){e(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(s,a)}c((o=o.apply(n,i||[])).next())}));var n,i,r,o}))}(s)}))))})();